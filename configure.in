AC_INIT(isync.h)
AM_INIT_AUTOMAKE(isync,0.7)
AM_PROG_CC_STDC
AC_ARG_WITH(ssl-dir, [  --with-ssl-dir=DIR	location where openssl is insalled],
	[if test -d $withval/lib; then
		LIBS="$LIBS -L$withval/lib"
		CFLAGS="$CFLAGS -I$withval/include"
	else
		AC_MSG_ERROR(can't find OpenSSL in $withval)
	fi])
AC_ARG_ENABLE(debug, [  --enable-debug		enable memory debugging
code],
	[AC_DEFINE(DEBUG),
	DEBUGOBJ=debug.o],
	[DEBUGOBJ=''])
AC_SUBST(DEBUGOBJ)
AC_CHECK_FUNCS(getopt_long)
AC_CHECK_LIB(socket,socket)
AC_CHECK_LIB(nsl,inet_ntoa)
AC_CHECK_LIB(crypto,ERR_error_string)
AC_CHECK_LIB(ssl,SSL_library_init)
dnl test for gcc.  use the prefix so we know that gcc-3.0 is also gcc
if test `echo $CC | sed 's/^gcc.*/gcc/'` = gcc; then
	CFLAGS="$CFLAGS -pipe -W -Wall -Wshadow -Wmissing-prototypes"
fi
AC_OUTPUT(Makefile)
